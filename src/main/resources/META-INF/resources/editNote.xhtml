<ui:composition xmlns:ui="http://xmlns.jcp.org/jsf/facelets" xmlns:p="http://primefaces.org/ui"
                xmlns:h="http://java.sun.com/jsf/html" xmlns:f="http://java.sun.com/jsf/core"
                template="/templates/template.xhtml">
    <ui:define name="title">
        <h:outputText value="#{labels['edit-note.title']}"/>
    </ui:define>

    <ui:define name="page-content">
        <h1><h:outputText value="#{labels['edit-note.title']}"/></h1>
        <h:form>
            <p:growl id="messages"/>
            <div class="ui-fluid">
                <div class="field grid">
                    <p:outputLabel for="folder-name" value="#{labels['edit-note.name']}"
                                   styleClass="col-12 mb-2 md:col-2 md:mb-0"/>
                    <div class="col-12 md:col-10">
                        <p:inputText id="folder-name" value="#{editNoteView.title}" styleClass="inputfield w-full"/>
                    </div>
                </div>
                <div class="field grid">
                    <p:outputLabel for="folder-description" value="#{labels['edit-note.description']}"
                                   styleClass="col-12 mb-2 md:col-2 md:mb-0"/>
                    <div class="col-12 md:col-10">
                        <p:inputText id="folder-description" value="#{editNoteView.description}" styleClass="inputfield w-full"/>
                    </div>
                </div>
                <div class="field grid">
                    <p:outputLabel for="number-pages" value="#{labels['edit-note.number-of-pages']}"
                                   styleClass="col-12 mb-2 md:col-2 md:mb-0"/>
                    <div class="col-12 md:col-10">
                        <p:inputText id="number-pages" value="#{editNoteView.numberOfPages}"
                                     styleClass="inputfield w-full"/>
                    </div>
                </div>
            <div class="field grid">
                <p:outputLabel for="select-author" value="#{labels['edit-note.author']}"
                               styleClass="col-12 mb-2 md:col-2 md:mb-0"/>
                <div class="col-12 md:col-10">
            <p:selectOneMenu id="select-author" filter="true" filterMatchMode="contains" styleClass="toolbar-grow"
                                 value="#{editNoteView.author}" style="min-width: 200px"
                                 converter="#{converterConfiguration.authorConverter}" required="true">
                    <f:selectItem itemLabel="#{labels['edit-note.select-author']}"/>
                    <f:selectItems value="#{editNoteView.allAuthors}" var="author"
                                   itemLabel="#{author.name} (#{author.extraInformation})" itemValue="#{author}" />
                    <p:ajax event="change" update="@this" />
                </p:selectOneMenu>
                </div>
            </div>
                <div class="field grid">
                    <p:outputLabel for="select-folder" value="#{labels['edit-note.folder']}"
                                   styleClass="col-12 mb-2 md:col-2 md:mb-0"/>
                    <div class="col-12 md:col-10">
                    <p:selectOneMenu id="select-folder" filter="true" filterMatchMode="contains" styleClass="toolbar-grow"
                                 value="#{editNoteView.currentFolder}" style="min-width: 200px"
                                 required="true"
                                 converter="#{converterConfiguration.folderConverter}">
                    <f:selectItem itemLabel="#{labels['edit-folder.select-parent-folder']}"/>
                    <f:selectItems value="#{editNoteView.allFolders}" var="folder"
                                   itemLabel="#{folder.name} (#{folder.id})" itemValue="#{folder}"/>
                    <p:ajax event="change" update="@this" />
                </p:selectOneMenu>
                    </div>
                </div>
                <div>
                    <div class="field grid">
                        <p:outputLabel for="pdf-available" value="#{labels['edit-note.pdf-available']}"
                                       styleClass="col-12 mb-2 md:col-2 md:mb-0"/>
                        <div class="col-12 md:col-10">
                            <p:selectBooleanCheckbox id="pdf-available"
                                              value="#{editNoteView.checkIfPDFForNoteIsAvailable()}" disabled="true"
                                                     styleClass="ui-inputfield w-full"/>
                        </div>
                </div>
            </div>
            </div>

            <div class="field grid">
            <p:outputLabel for="download-pdf" value="#{labels['edit-note.download-pdf']}"
                           styleClass="col-12 mb-2 md:col-2 md:mb-0"/>
            <div class="col-12 md:col-10">
                <p:commandButton id="download-pdf" value="Download" ajax="false"
                                 onclick="PrimeFaces.monitorDownload(start,
                stop);"
                                 icon="pi pi-arrow-down" styleClass="ui-inputfield w-full"
                                 rendered="#{editNoteView.checkIfPDFForNoteIsAvailable()}">
                    <p:fileDownload value="#{editNoteView.pdfForView}" contentDisposition="attachment" />
                </p:commandButton>
            </div>
            </div>


            <div class="field grid">
            <p:outputLabel for="download-pdf" value="#{labels['edit-note.open-pdf-in-new-tab']}"
                           styleClass="col-12 mb-2 md:col-2 md:mb-0"/>
            <div class="col-12 md:col-10">
            <p:commandButton id="open-pdf" onclick="this.form.target = '_blank'"
                             action="#{editNoteView.openFile()}" icon="pi pi-file-pdf"
                             ajax="false" value="#{labels['edit-note.open-pdf-in-new-tab']}"
                             rendered="#{editNoteView.checkIfPDFForNoteIsAvailable()}" />
            </div>
            </div>


            <div class="field grid">
                <p:outputLabel for="current-qr" value="#{labels['edit-note.current-qr']}"
                               styleClass="col-12 mb-2 md:col-2 md:mb-0"/>
                <div class="col-12 md:col-10">
                    <p:graphicImage id="current-qr" value="#{editNoteView.getCurrentStatusOfNote()}" stream="false"
                                    rendered="#{editNoteView.checkIfNoteIsAlreadySaved()}"/>
                </div>
            </div>

            <div class="field grid">
                <p:outputLabel for="current-qr" value="#{labels['edit-note.upload-pdf']}"
                               styleClass="col-12 mb-2 md:col-2 md:mb-0"/>
                <div class="col-12 md:col-10">
                    <p:fileUpload id="upload-pdf" value="#{editNoteView.uploadedFile}" mode="advanced"
                                  multiple="false"/>
                </div>
            </div>
            <p:commandButton value="#{labels['edit-note.back']}" action="#{editNoteView.navigateToViewFolders()}"
                             styleClass="form-button" immediate="true"/>
            <p:commandButton value="#{labels['edit-note.save']}" action="#{editNoteView.saveNote()}"
                             styleClass="form-button" ajax="false" update="messages"/>
            <p:commandButton value="#{labels['edit-note.create-another-note']}"
                             action="#{editNoteView.saveAndCreateAnotherNote()}"
                             styleClass="form-button" update="@form"/>
        </h:form>
    </ui:define>
</ui:composition>
