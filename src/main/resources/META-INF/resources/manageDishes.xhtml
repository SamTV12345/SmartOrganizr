<ui:composition xmlns="http://www.w3.org/1999/xhtml" xmlns:ui="http://xmlns.jcp.org/jsf/facelets"
	xmlns:h="http://xmlns.jcp.org/jsf/html" xmlns:f="http://xmlns.jcp.org/jsf/core" xmlns:p="http://primefaces.org/ui"
	template="/templates/template.xhtml">
	
	<ui:define name="title">
		<h:outputText value="#{labels['manage-dishes.title']}" />
	</ui:define>
	
	<ui:define name="page-content">
		<h1><h:outputText value="#{labels['manage-dishes.title']}" /></h1>
		
		<p:growl id="messages" />
		
		<h:form>
		
			<p:commandButton value="#{labels['manage-dishes.add-new-dish']}" action="editDish"/>
			
			<br />
			<br />
		
			<p:dataTable value="#{manageDishesView.dishes}" var="dish" id="dishes-table" reflow="true">
				<p:column headerText="#{labels['manage-dishes.column.number']}">
					<h:outputText value="#{dish.dishId}" />
				</p:column>
				
				<p:column>
					<p:graphicImage value="#{dish.imageData}" styleClass="table-image"
						rendered="#{dish.hasImageData()}" stream="false" />
					<p:graphicImage library="images" name="default.png" styleClass="table-image"
						rendered="#{not dish.hasImageData()}" />
				</p:column>
				
				<p:column headerText="#{labels['manage-dishes.column.name']}">
					<h:outputText value="#{dish.dishName}" />
				</p:column>
				
				<p:column headerText="#{labels['manage-dishes.column.price']}">
					<h:outputText value="#{dish.price}">
						<f:convertNumber currencyCode="EUR" type="currency" />
					</h:outputText>
				</p:column>
				
				<p:column headerText="#{labels['manage-dishes.column.category']}">
					<h:outputText value="#{labels[dish.category.i18nKey]}" />
				</p:column>
				
				<p:column headerText="#{labels['common.column.actions']}" styleClass="action-column">
					<p:commandButton icon="pi pi-pencil" styleClass="rounded-button table-button"
					                 action="#{manageDishesView.editDish(dish)}" />
					<p:commandButton icon="pi pi-trash" styleClass="rounded-button ui-button-danger table-button"
					                 action="#{manageDishesView.deleteDish(dish)}" update="messages dishes-table">
						<p:confirm header="#{labels['confirm-dialog.title']}"
										   message="#{labels['manage-dishes.confirm-remove-dish']}"
										   icon="pi pi-info-circle" />
					</p:commandButton>
				</p:column>
				
			</p:dataTable>
			
			<p:confirmDialog global="true" showEffect="fade" hideEffect="fade" responsive="true" width="350">
            	<p:commandButton value="#{labels['confirm-dialog.no']}" type="button"
            	                 styleClass="ui-confirmdialog-no ui-button-flat"/>
            	<p:commandButton value="#{labels['confirm-dialog.yes']}" type="button"
            	                 styleClass="ui-confirmdialog-yes" />
        	</p:confirmDialog>
		</h:form>
	</ui:define>
</ui:composition>